---
Author: Jan Wills
GENERATOR: 'Mozilla/4.06 (Macintosh; I; PPC) 
[Netscape
]'
title: 'REFINE1.md'
---

 

 **Grid Refinement and  Criteria - Algorithms**

  The Refine command for the grid generation code LaGriT uses various
  criteria to tag grid elements for refinement or derefinement. When
  utilizing unstructured grids generated by LaGriT for applications
  such as solution of partial differential equations (PDE) for
  physical systems, it is desirable to modify the grid in order to
  optimize it for the particular problem based on several principles.
  The goal is to produce a better solution by creating better grid
  elements in various regions of the domain of the PDE's. This can
  involve physical criteria such as choosing smaller elements where
  physical variables are rapidly changing or larger elements where the
  variables are relatively constant in order not to waste
  computational effort. Grid elements can also be chosen on various
  geometric criteria related to their shape such as different
  formulations of an aspect ratio. In time dependent problems, it may
  be necessary to refine and derefine the grid after each time step in
  order to follow various changing phenomena such as moving
  concentration fronts, shock waves, or advancing oxide layers. These
  factors make mesh refinement crucial to the practical solution of
  physical modeling problems. We therefore will detail several
  algorithms that are currently implemented for identifying which grid
  elements should be refined or derefined based on geometric and
  physical criteria. New algorithms will be added to this list and the
  current ones modified as we obtain feed back from users.



 

      I. Edges: Each edge is tested separately to see if it should be
 tagged for refinement or derefinement.

      Definition:

      c = a user supplied tolerance

      f(i) = value of the field variable f at node i

      l = length of the edge

      For the edge between nodes 1 and 2, we have

 <img height="300" width="300" src="image5.jpg)"129" "55"

      Criteria:

      1) Junction: Refine if the edge field values straddle c.

      Tag for refinement if

      f(1) &gt; c and f(2) &lt; c

      or

      f(1) &lt; c and f(2) &gt; c

      example: For c = 0, refine if f changes sign across the edge.

      2) Constant: Refine if the edgeís field values exceed c.

      Tag for refinement if

      f(1) &gt; c or f(2) &gt; c

      3) Maxsize: Refine if the edge length exceeds c.

      Tag if l &gt; c

      4) Delta: Refine if the magnitude of the difference of the field
 values at the edge ends exceeds c.

      Tag if   f(1) - f(2)  &gt; c

      5) Lambda Refine: Refine if lambda/dx &lt; c. Where dx  is a
 scale length (here taken to be the edge length)

 <img height="300" width="300" src="image9.jpg)"156" "52"

 Generally lambda/dx is a quality measure of the discretization. A
 larger value of usually indicates a better grid discretization.  There
 are some special cases.  If  one of the field values is zero as could
 happen on a boundary, then lambda/dx 1/2.  If f(1) is equal to  f(2)
 then lambda/dx  is divergent but the algorithm uses a  small number e
 = .000001 added to the denominator lambda/dx to give a large but
 finite value of lambda/dx thus indicating a good discretization.

  II. Faces: Each face is tested separately for refinement or
 derefinement. For the tetrahedral face defined by nodes 1, 2, and 3,
 we have

 <img height="300" width="300" src="image1.jpg)"154" "111"

  

      where A is the area of the face.

      Criteria:

      1) Junction: Refine if any of the faces field values straddle c.

      Tag for refinement if

      f(1) &gt; c and f(2), f(3) &lt; c

      or

      f(2) &gt; c and f(1), f(3) &lt; c

      or

      f(3) &gt; c and f(1), f(2) &lt; c

      or all of the above with &gt; and &lt; interchanged.

  example: For c = 0, refine if f changes sign between any of the
  three nodes.

  2) Constant:             Refine if any of the faces field values
 exceed c.

                                  Tag for refinement if

                                  f(1) &gt; 2 or f(2) &gt; c or f(3)
 &gt; c.

   

 3)Maxsize:                 Refine if the face area exceeds c.

                                    Tag if A &gt; c.

   

 4)Aspect Ratio: Refine if the faces aspect ratio is less than c. The
 aspect ratio (AR) is defined as the ratio of the radius of the
 inscribed circle of the  triangular face to the radius of the
 circumscribed circle. We renormalize this ratio of multiplying by 2 so
 that the ratio equals one for an equilateral triangle.

  

     AR=   2 RN            where RIN = radius of inscribed circle

                   ROUT
    
         ROUT = radius of circumscribed circle
  
   AR is never greater than one. Tag if AR &lt; c.   Generally the
   smaller AR is the more elongated the face is.

 5
) Lambda Refine: Refine if lamda &lt;c.  Where lambda is taken to be
 the radius of the circumscribed circle RC of the triangular face

  

  

       lambda = f(xcen)

                        grad f

 where xcen is the centroid of  the triangular face, and we have
 assumed a linear interpolation of f. grad fis evaluated on the face
 by a suitable approximation involving a linear interpolation of f and 
 the line integral around the edge of the face.

      

      III. Tets: Each tetrahedron is tested separately for refinement
 or derefinement

 <img height="300" width="300" src="image4.jpg)"155" "134"

  

  

      where V is the volume of the tetrahedron.

      Criteria:

      1) Junction: Refine if any of the tets field values straddle c.

      example: For c = 0 refine if f changes sign between any of the
 four nodes.

      2) Constant: Refine if any of the tets field values exceed c.

    Tag for refinement if

   f(1) &gt; c or f(2) &gt; c or f(3) &gt; c or f(4) &gt; c

      3) Maxsize: Refine if the tet volume exceeds c.

   Tag if V &gt; c

      4) Aspect Ratio: Refine if the tets aspect ratio is less than c.
 For the tet the aspect ratio (AR) is defined as the ratio of the
 radius of the inscribed sphere of the

      tet to the radius of the circumscribed sphere. We renormalize
 this ratio by multiplying by three so that the ratio equals one for a
 regular tetrahedron (composed

      of equilateral triangular faces).

  

  AR = 3 RIN/ROUT  where RIN radius of inscribed sphere

  ROUT radius of circumscribed sphere

  AR is never greater than one.

      Tag if AR &lt; c.

      Generally the smaller AR is, the more elongated the tet is.

      6) Lambda Refine: Refine if lamda/dx &gt;c . Where lambda is
 taken to be the radius of the circumscribed sphere ROUT of the tet.

      lambda =  f(xcen)  / grad f

      f(xcen) = (f(1) + f(2) + f(3) + f(4))/4

      where xcen is the centroid of the tet, and we have assumed linear
 interpolations of f.  grad f is evalutaed for the tet by an
 approximation involving linear

      interpolation au the surface integral  over the surface of the
 tet.

  

  

      IV. Face Edges: Same algorithms of the Faces category except all
 edges of the face are tagged for refinement or derefinement if the
 condition is met for the

      face.

      V. Tet Edges: Same algorithms of the tet category except all
 edges of the tet are tagged for refinement or derefinement if the
 condition is met for the tet.


